<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tally Data Extraction Reference</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Enterprise Blue & Slate. Clean, high contrast, readable. -->
    <!-- 
    Application Structure Plan:
    - Layout: Sidebar navigation (sticky on desktop) + Main Content Area.
    - Section 1: Overview (Brief context).
    - Section 2: Object Library (Categorized list of all Tally Masters/Transactions).
    - Section 3: Report Integration (Static XML Code Snippets for major reports).
    - Section 4: Extraction Methods (Refined comparison table).
    - Goal: A static, high-quality technical reference manual for developers.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        /* Custom Scrollbar for code blocks */
        .code-block::-webkit-scrollbar { height: 8px; }
        .code-block::-webkit-scrollbar-track { background: #f1f5f9; }
        .code-block::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .code-block::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Syntax Highlighting Colors */
        .token-tag { color: #22863a; }
        .token-attr { color: #6f42c1; }
        .token-val { color: #032f62; }
        .token-content { color: #24292e; }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b', // Darker slate for sidebar
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white text-slate-800 antialiased flex flex-col md:flex-row min-h-screen">

    <!-- Sidebar Navigation -->
    <aside class="w-full md:w-64 bg-slate-900 text-slate-300 flex-shrink-0 md:h-screen md:sticky md:top-0 overflow-y-auto">
        <div class="p-6 border-b border-slate-800">
            <h1 class="text-xl font-bold text-white tracking-tight">Tally<span class="text-blue-500">Extractor</span> Docs</h1>
            <p class="text-xs text-slate-500 mt-1">Technical Reference v1.2</p>
        </div>
        <nav class="p-4 space-y-1">
            <a href="#overview" class="block px-4 py-2 rounded hover:bg-slate-800 hover:text-white transition-colors text-sm font-medium">Overview</a>
            <a href="#master-list" class="block px-4 py-2 rounded hover:bg-slate-800 hover:text-white transition-colors text-sm font-medium">Master Collections</a>
            <a href="#transaction-list" class="block px-4 py-2 rounded hover:bg-slate-800 hover:text-white transition-colors text-sm font-medium">Transaction Types</a>
            <a href="#code-snippets" class="block px-4 py-2 rounded hover:bg-slate-800 hover:text-white transition-colors text-sm font-medium">Report XML Snippets</a>
            <a href="#methods" class="block px-4 py-2 rounded hover:bg-slate-800 hover:text-white transition-colors text-sm font-medium">Extraction Methods</a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 min-w-0 overflow-hidden">
        <div class="max-w-5xl mx-auto px-6 py-12 space-y-16">

            <!-- Overview -->
            <section id="overview">
                <h2 class="text-3xl font-bold text-slate-900 mb-4">Tally Data Extraction Guide</h2>
                <p class="text-lg text-slate-600 leading-relaxed">
                    This documentation provides a comprehensive list of Tally ERP 9 / Tally Prime objects and standard XML patterns for extracting data to SQL, Power BI, or custom applications. Tally uses a hierarchical object model rather than a relational table structure.
                </p>
            </section>

            <!-- Master Lists -->
            <section id="master-list" class="scroll-mt-12">
                <div class="border-l-4 border-blue-600 pl-4 mb-6">
                    <h3 class="text-2xl font-bold text-slate-900">1. Master Collections</h3>
                    <p class="text-slate-500">Static data entities that define the structure of accounts and inventory.</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Accounting Masters -->
                    <div class="bg-slate-50 rounded-lg border border-slate-200 p-5">
                        <h4 class="font-bold text-slate-800 border-b border-slate-200 pb-2 mb-3 flex items-center gap-2">
                            <span class="w-2 h-2 bg-blue-500 rounded-full"></span> Accounting
                        </h4>
                        <ul class="space-y-2 text-sm text-slate-600 font-mono">
                            <li class="flex justify-between"><span class="font-semibold">Group</span> <span class="text-xs text-slate-400">Hierarchical parent</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Ledger</span> <span class="text-xs text-slate-400">Main account object</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Cost Category</span> <span class="text-xs text-slate-400">Dim 1 container</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Cost Centre</span> <span class="text-xs text-slate-400">Dimension/Tag</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Voucher Type</span> <span class="text-xs text-slate-400">Config definitions</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Currency</span> <span class="text-xs text-slate-400">Multi-currency</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Budget</span> <span class="text-xs text-slate-400">Financial targets</span></li>
                        </ul>
                    </div>

                    <!-- Inventory Masters -->
                    <div class="bg-slate-50 rounded-lg border border-slate-200 p-5">
                        <h4 class="font-bold text-slate-800 border-b border-slate-200 pb-2 mb-3 flex items-center gap-2">
                            <span class="w-2 h-2 bg-green-500 rounded-full"></span> Inventory
                        </h4>
                        <ul class="space-y-2 text-sm text-slate-600 font-mono">
                            <li class="flex justify-between"><span class="font-semibold">Stock Group</span> <span class="text-xs text-slate-400">Hierarchy</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Stock Item</span> <span class="text-xs text-slate-400">Product/Service</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Stock Category</span> <span class="text-xs text-slate-400">Parallel hierarchy</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Unit</span> <span class="text-xs text-slate-400">UOM definitions</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Godown</span> <span class="text-xs text-slate-400">Locations/Warehouses</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Batch</span> <span class="text-xs text-slate-400">Lot numbers</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Price List</span> <span class="text-xs text-slate-400">Rate definitions</span></li>
                        </ul>
                    </div>

                    <!-- Payroll & Statutory -->
                    <div class="bg-slate-50 rounded-lg border border-slate-200 p-5">
                        <h4 class="font-bold text-slate-800 border-b border-slate-200 pb-2 mb-3 flex items-center gap-2">
                            <span class="w-2 h-2 bg-purple-500 rounded-full"></span> Payroll & Other
                        </h4>
                        <ul class="space-y-2 text-sm text-slate-600 font-mono">
                            <li class="flex justify-between"><span class="font-semibold">Employee Group</span> <span class="text-xs text-slate-400">Dept/Div</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Employee</span> <span class="text-xs text-slate-400">Staff master</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Pay Head</span> <span class="text-xs text-slate-400">Salary components</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Attendance Type</span> <span class="text-xs text-slate-400">Leave definitions</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Tax Classification</span> <span class="text-xs text-slate-400">GST/VAT Rates</span></li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Transaction Lists -->
            <section id="transaction-list" class="scroll-mt-12">
                <div class="border-l-4 border-blue-600 pl-4 mb-6">
                    <h3 class="text-2xl font-bold text-slate-900">2. Transactions (Vouchers)</h3>
                    <p class="text-slate-500">All transactions are stored in the <code class="bg-slate-100 px-1 rounded text-sm">Voucher</code> object. They are differentiated by <code class="bg-slate-100 px-1 rounded text-sm">VoucherTypeName</code>.</p>
                </div>

                <div class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden">
                    <table class="min-w-full divide-y divide-slate-200">
                        <thead class="bg-slate-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Voucher Type</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Purpose</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Key Sub-Collections</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-slate-200 text-sm">
                            <tr>
                                <td class="px-6 py-4 font-medium text-slate-900">Sales / Sales Order</td>
                                <td class="px-6 py-4 text-slate-600">Revenue recording, Invoicing.</td>
                                <td class="px-6 py-4 text-slate-500 font-mono text-xs">InventoryEntries, LedgerEntries</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium text-slate-900">Purchase / Purchase Order</td>
                                <td class="px-6 py-4 text-slate-600">Procurement, Expense recording.</td>
                                <td class="px-6 py-4 text-slate-500 font-mono text-xs">InventoryEntries, LedgerEntries</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium text-slate-900">Receipt / Payment</td>
                                <td class="px-6 py-4 text-slate-600">Bank/Cash inflows and outflows.</td>
                                <td class="px-6 py-4 text-slate-500 font-mono text-xs">LedgerEntries, BankAllocations</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium text-slate-900">Journal</td>
                                <td class="px-6 py-4 text-slate-600">Adjustments, non-cash transactions.</td>
                                <td class="px-6 py-4 text-slate-500 font-mono text-xs">LedgerEntries</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium text-slate-900">Contra</td>
                                <td class="px-6 py-4 text-slate-600">Cash deposit/withdrawal, Fund transfer.</td>
                                <td class="px-6 py-4 text-slate-500 font-mono text-xs">LedgerEntries</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 font-medium text-slate-900">Debit / Credit Note</td>
                                <td class="px-6 py-4 text-slate-600">Returns, Rate differences.</td>
                                <td class="px-6 py-4 text-slate-500 font-mono text-xs">InventoryEntries, LedgerEntries</td>
                            </tr>
                             <tr>
                                <td class="px-6 py-4 font-medium text-slate-900">Stock Journal</td>
                                <td class="px-6 py-4 text-slate-600">Manufacturing, Transfer of materials.</td>
                                <td class="px-6 py-4 text-slate-500 font-mono text-xs">InventoryEntries (In/Out)</td>
                            </tr>
                             <tr>
                                <td class="px-6 py-4 font-medium text-slate-900">Payroll Voucher</td>
                                <td class="px-6 py-4 text-slate-600">Salary processing.</td>
                                <td class="px-6 py-4 text-slate-500 font-mono text-xs">AttendanceEntries, PayHeadEntries</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Code Snippets -->
            <section id="code-snippets" class="scroll-mt-12">
                <div class="border-l-4 border-blue-600 pl-4 mb-6">
                    <h3 class="text-2xl font-bold text-slate-900">3. Developer Reference: XML Snippets</h3>
                    <p class="text-slate-500">Send these XML payloads to Tally's HTTP port (default: <code class="text-xs bg-slate-100 p-1">http://localhost:9000</code>) via POST method to fetch data.</p>
                </div>

                <!-- Tabs for Snippets -->
                <div class="mb-4 border-b border-slate-200">
                    <nav class="-mb-px flex space-x-8" id="snippetTabs">
                        <button onclick="showSnippet('tb')" class="snippet-tab border-blue-500 text-blue-600 whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm">Trial Balance</button>
                        <button onclick="showSnippet('daybook')" class="snippet-tab border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm">Daybook (Vouchers)</button>
                        <button onclick="showSnippet('sql')" class="snippet-tab border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 whitespace-nowrap pb-4 px-1 border-b-2 font-medium text-sm">Raw SQL Query (ODBC)</button>
                    </nav>
                </div>

                <!-- Snippet 1: Trial Balance -->
                <div id="snip-tb" class="snippet-content">
                    <p class="text-sm text-slate-600 mb-3">Use this to export the standard "Trial Balance" report structure. This utilizes the <code class="font-mono text-xs">EXPORT</code> method.</p>
                    <div class="bg-slate-900 rounded-lg p-4 overflow-x-auto code-block shadow-inner">
<pre class="text-xs font-mono leading-5">
<span class="token-tag">&lt;ENVELOPE&gt;</span>
    <span class="token-tag">&lt;HEADER&gt;</span>
        <span class="token-tag">&lt;TALLYREQUEST&gt;</span>Export Data<span class="token-tag">&lt;/TALLYREQUEST&gt;</span>
    <span class="token-tag">&lt;/HEADER&gt;</span>
    <span class="token-tag">&lt;BODY&gt;</span>
        <span class="token-tag">&lt;EXPORTDATA&gt;</span>
            <span class="token-tag">&lt;REQUESTDESC&gt;</span>
                <span class="token-tag">&lt;REPORTNAME&gt;</span>Trial Balance<span class="token-tag">&lt;/REPORTNAME&gt;</span>
                <span class="token-tag">&lt;STATICVARIABLES&gt;</span>
                    <span class="token-tag">&lt;SVEXPORTFORMAT&gt;</span>$$SysName:XML<span class="token-tag">&lt;/SVEXPORTFORMAT&gt;</span>
                <span class="token-tag">&lt;/STATICVARIABLES&gt;</span>
            <span class="token-tag">&lt;/REQUESTDESC&gt;</span>
        <span class="token-tag">&lt;/EXPORTDATA&gt;</span>
    <span class="token-tag">&lt;/BODY&gt;</span>
<span class="token-tag">&lt;/ENVELOPE&gt;</span>
</pre>
                    </div>
                </div>

                <!-- Snippet 2: Daybook -->
                <div id="snip-daybook" class="snippet-content hidden">
                    <p class="text-sm text-slate-600 mb-3">Use this to fetch raw Voucher objects within a specific date range. This is the most common pattern for ETL.</p>
                    <div class="bg-slate-900 rounded-lg p-4 overflow-x-auto code-block shadow-inner">
<pre class="text-xs font-mono leading-5">
<span class="token-tag">&lt;ENVELOPE&gt;</span>
    <span class="token-tag">&lt;HEADER&gt;</span>
        <span class="token-tag">&lt;TALLYREQUEST&gt;</span>Export Data<span class="token-tag">&lt;/TALLYREQUEST&gt;</span>
    <span class="token-tag">&lt;/HEADER&gt;</span>
    <span class="token-tag">&lt;BODY&gt;</span>
        <span class="token-tag">&lt;EXPORTDATA&gt;</span>
            <span class="token-tag">&lt;REQUESTDESC&gt;</span>
                <span class="token-tag">&lt;REPORTNAME&gt;</span>Voucher Register<span class="token-tag">&lt;/REPORTNAME&gt;</span>
                <span class="token-tag">&lt;STATICVARIABLES&gt;</span>
                    <span class="token-tag">&lt;SVFROMDATE&gt;</span>20230401<span class="token-tag">&lt;/SVFROMDATE&gt;</span>
                    <span class="token-tag">&lt;SVTODATE&gt;</span>20230430<span class="token-tag">&lt;/SVTODATE&gt;</span>
                    <span class="token-tag">&lt;SVEXPORTFORMAT&gt;</span>$$SysName:XML<span class="token-tag">&lt;/SVEXPORTFORMAT&gt;</span>
                <span class="token-tag">&lt;/STATICVARIABLES&gt;</span>
            <span class="token-tag">&lt;/REQUESTDESC&gt;</span>
        <span class="token-tag">&lt;/EXPORTDATA&gt;</span>
    <span class="token-tag">&lt;/BODY&gt;</span>
<span class="token-tag">&lt;/ENVELOPE&gt;</span>
</pre>
                    </div>
                </div>

                <!-- Snippet 3: SQL -->
                <div id="snip-sql" class="snippet-content hidden">
                    <p class="text-sm text-slate-600 mb-3">If using the ODBC Driver (Port 9000), you can use standard SQL Select statements. Note: This is slower than XML.</p>
                    <div class="bg-slate-900 rounded-lg p-4 overflow-x-auto code-block shadow-inner">
<pre class="text-xs font-mono text-blue-300 leading-5">
-- Select Ledger Masters
SELECT $Name, $Parent, $OpeningBalance FROM Ledger

-- Select Vouchers
SELECT $Date, $VoucherNumber, $PartyLedgerName, $Amount 
FROM Voucher 
WHERE $VoucherTypeName = 'Sales'
</pre>
                    </div>
                </div>

            </section>

            <!-- Methods Comparison -->
            <section id="methods" class="pb-16 scroll-mt-12">
                 <div class="border-l-4 border-blue-600 pl-4 mb-6">
                    <h3 class="text-2xl font-bold text-slate-900">4. Extraction Methods</h3>
                    <p class="text-slate-500">Comparison of available integration architectures.</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Method 1 -->
                    <div class="border border-slate-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                        <h4 class="font-bold text-slate-800 mb-2">XML over HTTP (Recommended)</h4>
                        <p class="text-sm text-slate-600 mb-4">The standard for high-volume extraction. Tally acts as a server receiving XML requests.</p>
                        <ul class="text-xs space-y-1 text-slate-500">
                            <li>✅ Fast & robust</li>
                            <li>✅ Full data access</li>
                            <li>❌ Requires parsing logic</li>
                        </ul>
                    </div>

                    <!-- Method 2 -->
                    <div class="border border-slate-200 rounded-lg p-6 hover:shadow-md transition-shadow">
                        <h4 class="font-bold text-slate-800 mb-2">ODBC Interface</h4>
                        <p class="text-sm text-slate-600 mb-4">Tally acts as a database driver. Good for ad-hoc queries via Excel/PowerBI.</p>
                         <ul class="text-xs space-y-1 text-slate-500">
                            <li>✅ Easy setup (Excel)</li>
                            <li>❌ Very slow for large data</li>
                            <li>❌ Limited schema support</li>
                        </ul>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <script>
        function showSnippet(id) {
            // Hide all snippets
            document.querySelectorAll('.snippet-content').forEach(el => el.classList.add('hidden'));
            // Show selected snippet
            document.getElementById('snip-' + id).classList.remove('hidden');

            // Reset Tabs
            document.querySelectorAll('.snippet-tab').forEach(el => {
                el.classList.remove('border-blue-500', 'text-blue-600');
                el.classList.add('border-transparent', 'text-slate-500');
            });
            
            // Activate Tab
            const activeTab = document.querySelector(`button[onclick="showSnippet('${id}')"]`);
            activeTab.classList.remove('border-transparent', 'text-slate-500');
            activeTab.classList.add('border-blue-500', 'text-blue-600');
        }
    </script>
</body>
</html>
